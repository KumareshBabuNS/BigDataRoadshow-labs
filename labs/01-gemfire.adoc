
= Gemfire Lab
The purpose of this lab is to get a basic understanding of how a Gemfire cluster works and how it can be used.

== Exploring gfsh
gfsh (Gemfire shell) is a interactive command line interface that allows you to, manage, moniter and administrate Gemfire processes +
Through out this lab gfsh will be used to start and stop processes and also to initiate other commands to the cluster
To start gfsh execute the following steps: +
1. Right click on the desktop and select _Open In Terminal_ +
2. In the terminal type "'gfsh'" +

The following interface will appear:
[source]
    _________________________     __
   / _____/ ______/ ______/ /____/ /
  / /  __/ /___  /_____  / _____  / 
 / /__/ / ____/  _____/ / /    / /  
/______/_/      /______/_/    /_/    v8.1.0

Monitor and Manage GemFire
gfsh>
[source]

gfsh is interactive and contains auto completes to assist users. This functionality can be triggered by pressing the tab key. Press tab now to list all the commands gfsh can perform.

== Starting The First Member of the Cluster
The locator is a Pivotal GemFire process that tells new, connecting members/clients where running members are located and provides load balancing for server use. +
This locator will be the first member in the cluster and will act as the membership coordinator as well as the management node. +
Copy and paste the following command into gfsh: +
[source, bash]
start locator --name=locatorA --enable-cluster-configuration=false --port=10334 --log-level=config --J=-Xms64m --J=-Xmx64m --J=-Dgemfire.http-service-port=7575_
[source]

The command will produce an output similar to this: +
****
_gfsh>start locator --name=locatorA --enable-cluster-configuration=false --port=10334 --log-level=config --J=-Xms64m --J=-Xmx64m --J=-Dgemfire.http-service-port=7575
Starting a GemFire Locator in /home/gemfire/locatorA...
Locator in /home/gemfire/locatorA on 192.168.75.9[10334] as locatorA is currently online.
Process ID: 67956
Uptime: 16 seconds
GemFire Version: 8.1.0
Java Version: 1.7.0_71
Log File: /home/gemfire/locatorA/locatorA.log
JVM Arguments: -Dgemfire.enable-cluster-configuration=false -Dgemfire.load-cluster-configuration-from-dir=false -Dgemfire.log-level=config -Xms64m -Xmx64m -Dgemfire.http-service-port=7575 -Dgemfire.launcher.registerSignalHandlers=true -Djava.awt.headless=true -Dsun.rmi.dgc.server.gcInterval=9223372036854775806
Class-Path: /home/gemfire/gemfire/Pivotal_GemFire/lib/gemfire.jar:/home/gemfire/gemfire/Pivotal_GemFire/lib/locator-dependencies.jar_

Successfully connected to: [host=192.168.75.9, port=1099]
****
Congratulations, you now have the beginning of a Gemfire cluster.

== Log Into Pulse
GemFire Pulse is a Web Application that provides a graphical dashboard for monitoring vital, real-time health and performance of GemFire clusters, members, and regions. +
With the first locator started, Pulse is now available. +
To start up Pulse, open a browser and enter this URL in the address bar: +
http://localhost:7575/pulse/Login.html +

Log In with the following credentials: +
username: *admin* +
password: *admin* +
Once logged in click on green server box Icon in the Cluster View to see the Gemfire processes running on the server. +
For the lab all processes will be on this machine.
image::/01-gemfire/images/pulse-cluster-view.png


== Start another Locator
This locator will join with the first giving us fail over for Locator functionality. +
Return to the gfsh session and enter the following command: +
_start locator --name=locatorB --enable-cluster-configuration=false --locators=127.0.0.1[10334],127.0.0.1[10335] --port=10335 --log-level=config --J=-Xms64m --J=-Xmx64m --J=-Dgemfire.http-service-port=7576_ +

The resulting output should look like the following: +
****
Locator in /home/gemfire/locatorB on 192.168.75.9[10335] as locatorB is currently online.
Process ID: 72956
Uptime: 4 seconds
GemFire Version: 8.1.0
Java Version: 1.7.0_71
Log File: /home/gemfire/locatorB/locatorB.log
JVM Arguments: -Dgemfire.locators=127.0.0.1[10334],127.0.0.1[10335] -Dgemfire.enable-cluster-configuration=false -Dgemfire.load-cluster-configuration-from-dir=false -Dgemfire.log-level=config -Xms64m -Xmx64m -Dgemfire.http-service-port=7576 -Dgemfire.launcher.registerSignalHandlers=true -Djava.awt.headless=true -Dsun.rmi.dgc.server.gcInterval=9223372036854775806
Class-Path: /home/gemfire/gemfire/Pivotal_GemFire/lib/gemfire.jar:/home/gemfire/gemfire/Pivotal_GemFire/lib/locator-dependencies.jar
****

Pulse will now show two locator processes. Also in the panel across the top the Total Heap, Members and Locators counts will have increased.

== Add Server A
A GemFire server is a Pivotal GemFire process that runs as a long-lived, configurable member of a distributed system. +
The server is what contains the Regions which in turn contains the data. Servers can also bring the compute to the data, similar to stored Procedures, by deploying java logic into them. +

To start a server process copy the following command into gfsh: +
_start server --name=serverA --use-cluster-configuration=false --server-port=0 --locators=127.0.0.1[10334],127.0.0.1[10335] --J=-Dgemfire.http-service-port=7577 --J=-Dgemfire.start-dev-rest-api=true --J=-Xms128m --J=-Xmx128m_

The output will look similar to this: +

****
_Server in /home/gemfire/serverA on 192.168.75.9[33971] as serverA is currently online.
Process ID: 88547
Uptime: 9 seconds
GemFire Version: 8.1.0
Java Version: 1.7.0_71
Log File: /home/gemfire/serverA/serverA.log
JVM Arguments: -Dgemfire.locators=127.0.0.1[10334],127.0.0.1[10335] -Dgemfire.use-cluster-configuration=false -Dgemfire.http-service-port=7577 -Dgemfire.start-dev-rest-api=true -Xms128m -Xmx128m -XX:OnOutOfMemoryError=kill -KILL %p -Dgemfire.launcher.registerSignalHandlers=true -Djava.awt.headless=true -Dsun.rmi.dgc.server.gcInterval=9223372036854775806
Class-Path: /home/gemfire/gemfire/Pivotal_GemFire/lib/gemfire.jar:/home/gemfire/gemfire/Pivotal_GemFire/lib/server-dependencies.jar_
****
Pulse will now also show the new member as well as the increase in memory capacity the addition of this process provided. +

The members can also be view in gfsh by typing this command (remember by pressing tab as you type, autocomplete will help):
_list members_ +

The output will look something like this: +
[source]
gfsh>list members +
  Name   | Id +
-------- | ----------------------------------------------
locatorB | 192.168.75.9(locatorB:72956:locator)<v1>:20048
serverA  | 192.168.75.9(serverA:88547)<v2>:24402
locatorA | 192.168.75.9(locatorA:72292:locator)<v0>:58229
[source]







